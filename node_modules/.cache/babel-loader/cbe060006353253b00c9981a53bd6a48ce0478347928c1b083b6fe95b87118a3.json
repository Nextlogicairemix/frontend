{"ast":null,"code":"import _objectSpread from\"C:/Users/sar3e.DESKTOP-RCKHLIM/Documents/remixback/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useState,useEffect}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||\"https://back-thbr.onrender.com\";const ENDPOINTS={REGISTER:\"/api/auth/register\",LOGIN:\"/api/auth/login\",LOGOUT:\"/api/auth/logout\",ME:\"/api/auth/me\"};const apiFetch=async function(endpoint){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const defaultOptions={credentials:\"include\",headers:_objectSpread({\"Content-Type\":\"application/json\"},options.headers)};const response=await fetch(\"\".concat(API_URL).concat(endpoint),_objectSpread(_objectSpread({},defaultOptions),options));if(!response.ok){const error=await response.json().catch(()=>({error:\"Network error\"}));throw new Error(error.error||\"Something went wrong\");}return response.json();};const AuthContext=/*#__PURE__*/createContext(null);export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{checkAuth();},[]);const checkAuth=async()=>{try{const data=await apiFetch(ENDPOINTS.ME);setUser(data);}catch(err){console.log(\"Not authenticated\");setUser(null);}finally{setLoading(false);}};const login=async(email,password)=>{setError(null);try{const data=await apiFetch(ENDPOINTS.LOGIN,{method:\"POST\",body:JSON.stringify({email,password})});setUser(data.user);return{success:true,user:data.user};}catch(err){setError(err.message);return{success:false,error:err.message};}};const register=async function(name,email,password){let accessCode=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;setError(null);try{const data=await apiFetch(ENDPOINTS.REGISTER,{method:\"POST\",body:JSON.stringify({name,email,password,access_code:accessCode})});return{success:true,message:data.message};}catch(err){setError(err.message);return{success:false,error:err.message};}};const logout=async()=>{try{await apiFetch(ENDPOINTS.LOGOUT,{method:\"POST\"});setUser(null);}catch(err){console.error(\"Logout error:\",err);}};const isTeacher=()=>(user===null||user===void 0?void 0:user.role)===\"admin\";const isStudent=()=>(user===null||user===void 0?void 0:user.role)===\"student\";return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,loading,error,login,register,logout,checkAuth,isTeacher,isStudent},children:children});};export const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error(\"useAuth must be used within AuthProvider\");}return context;};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","jsx","_jsx","API_URL","process","env","REACT_APP_API_URL","ENDPOINTS","REGISTER","LOGIN","LOGOUT","ME","apiFetch","endpoint","options","arguments","length","undefined","defaultOptions","credentials","headers","_objectSpread","response","fetch","concat","ok","error","json","catch","Error","AuthContext","AuthProvider","_ref","children","user","setUser","loading","setLoading","setError","checkAuth","data","err","console","log","login","email","password","method","body","JSON","stringify","success","message","register","name","accessCode","access_code","logout","isTeacher","role","isStudent","Provider","value","useAuth","context"],"sources":["C:/Users/sar3e.DESKTOP-RCKHLIM/Documents/remixback/frontend/src/AuthContext.js"],"sourcesContent":["\r\nimport React, { createContext, useContext, useState, useEffect } from \"react\";\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || \"https://back-thbr.onrender.com\";\r\n\r\nconst ENDPOINTS = {\r\n  REGISTER: \"/api/auth/register\",\r\n  LOGIN: \"/api/auth/login\",\r\n  LOGOUT: \"/api/auth/logout\",\r\n  ME: \"/api/auth/me\",\r\n};\r\n\r\n\r\nconst apiFetch = async (endpoint, options = {}) => {\r\n  const defaultOptions = {\r\n    credentials: \"include\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      ...options.headers,\r\n    },\r\n  };\r\n\r\n  const response = await fetch(`${API_URL}${endpoint}`, {\r\n    ...defaultOptions,\r\n    ...options,\r\n  });\r\n\r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({ error: \"Network error\" }));\r\n    throw new Error(error.error || \"Something went wrong\");\r\n  }\r\n\r\n  return response.json();\r\n};\r\n\r\n\r\nconst AuthContext = createContext(null);\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n\r\n  useEffect(() => {\r\n    checkAuth();\r\n  }, []);\r\n\r\n  const checkAuth = async () => {\r\n    try {\r\n      const data = await apiFetch(ENDPOINTS.ME);\r\n      setUser(data);\r\n    } catch (err) {\r\n      console.log(\"Not authenticated\");\r\n      setUser(null);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n\r\n  const login = async (email, password) => {\r\n    setError(null);\r\n    try {\r\n      const data = await apiFetch(ENDPOINTS.LOGIN, {\r\n        method: \"POST\",\r\n        body: JSON.stringify({ email, password }),\r\n      });\r\n      setUser(data.user);\r\n      return { success: true, user: data.user };\r\n    } catch (err) {\r\n      setError(err.message);\r\n      return { success: false, error: err.message };\r\n    }\r\n  };\r\n\r\n  const register = async (name, email, password, accessCode = null) => {\r\n    setError(null);\r\n    try {\r\n      const data = await apiFetch(ENDPOINTS.REGISTER, {\r\n        method: \"POST\",\r\n        body: JSON.stringify({ name, email, password, access_code: accessCode }),\r\n      });\r\n      return { success: true, message: data.message };\r\n    } catch (err) {\r\n      setError(err.message);\r\n      return { success: false, error: err.message };\r\n    }\r\n  };\r\n\r\n  const logout = async () => {\r\n    try {\r\n      await apiFetch(ENDPOINTS.LOGOUT, { method: \"POST\" });\r\n      setUser(null);\r\n    } catch (err) {\r\n      console.error(\"Logout error:\", err);\r\n    }\r\n  };\r\n\r\n  const isTeacher = () => user?.role === \"admin\";\r\n  const isStudent = () => user?.role === \"student\";\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        user,\r\n        loading,\r\n        error,\r\n        login,\r\n        register,\r\n        logout,\r\n        checkAuth,\r\n        isTeacher,\r\n        isStudent,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error(\"useAuth must be used within AuthProvider\");\r\n  }\r\n  return context;\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}